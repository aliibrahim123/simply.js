var $=Object.defineProperty;var n=(o,e)=>$(o,"name",{value:e,configurable:!0});var M=(o,e)=>{for(var t in e)$(o,t,{get:e[t],enumerable:!0})};var s=class extends Error{constructor(e="serve: empty"){var t=e.indexOf(":");super(e.slice(t+1).trim()),this.name=e.slice(0,t)}};n(s,"ServerError");var N=n((o,e)=>{if(!Array.isArray(o))throw new s(`serve: ${e} of type (${o?.constructor?.name}), expected (Array)`)},"checkarr"),l=n((o,e)=>{if(typeof o!="function")throw new s(`serve: ${e} of type (${o?.constructor?.name}), expected (Function)`)},"checkfn"),v=n((o,e="str")=>{if(typeof o!="string")throw new s(`serve: ${e} of type (${o?.constructor?.name}), expected (String)`)},"checkstr");var _=n((o,e,t,r,p,d)=>(v(o,"path"),o.split("/").reduce((i,a,f,x)=>{var h=f===x.length-1;if(a[0]==="["){if(i.routes["[PARAM]"]){let u=i.routes["[PARAM]"];if(u.name!==a.slice(1,-1))throw new s(`serve: accessing parametric route (${u.path}) with name (${a})`);return u}return i.routes["[PARAM]"]=new d(t,i,h&&r,a,p)}return i.routes[a]?i.routes[a]:i.routes[a]=new d(t,i,h&&r,a,p)},e)),"addRoute");var k=["connect","delete","get","head","options","patch","post","put","trace"],c=class{constructor(e,t,r,p="",d={}){if(v(p,"name"),this.name=p.startsWith("[")?p.slice(1,-1):p,this.path=t?t.path+"/"+p:"",this.router=e,this.parent=t,this.handler={},!r)this.handler=null;else if(typeof r=="function")this.handler=r;else if(typeof r=="object")for(let a in r)this.method(a,r[a]);else throw new s(`serve: handler at path (${this.path}) of type (${r?.constructor?.name}), expected (Function) or (Object)`);var{portal:i}={portal:!1,...d};this.portal=i,this.routes={}}method(e,t){if(v(e,"method"),l(t,"handler"),this.handler===null)this.handler={};else if(typeof this.handler=="function")throw new s(`serve: adding methed (${e}) for (${this.path}) in presence of (all) handler`);if(k.includes(e))this.handler[e]=t;else throw new s(`serve: unsupported http method (${e}) at path (${this.path})`);return this}route(e,t,r={}){return _(e,this,this.router,t,r,c)}all(e,t){if(typeof e=="function"){if(l(e,"handler"),this.handler)throw new s(`can not add handler in presence of other at path (${this.path})`);return this.handler=e,this}return this.route(e,t)}connect(e,t){return typeof e=="function"?this.method("connect",e):this.route(e).method("connect",t)}delete(e,t){return typeof e=="function"?this.method("delete",e):this.route(e).method("delete",t)}get(e,t){return typeof e=="function"?this.method("get",e):this.route(e).method("get",t)}head(e,t){return typeof e=="function"?this.method("head",e):this.route(e).method("head",t)}options(e,t){return typeof e=="function"?this.method("options",e):this.route(e).method("options",t)}patch(e,t){return typeof e=="function"?this.method("patch",e):this.route(e).method("patch",t)}post(e,t){return typeof e=="function"?this.method("post",e):this.route(e).method("post",t)}put(e,t){return typeof e=="function"?this.method("put",e):this.route(e).method("put",t)}trace(e,t){return typeof e=="function"?this.method("trace",e):this.route(e).method("trace",t)}};n(c,"Route");var P={};M(P,{no_handler:()=>R,undefined_method:()=>g,undefined_route:()=>w});var w=Symbol("undefined_route"),R=Symbol("no_handler"),g=Symbol("undefined_method");var S={};M(S,{Accepted:()=>U,Already_Reported:()=>B,Bad_Gateway:()=>Pe,Bad_Request:()=>Y,Conflict:()=>ne,Content_Too_Large:()=>he,Continue:()=>C,Created:()=>L,Early_Hints:()=>E,Expectation_Failed:()=>fe,Failed_Dependency:()=>_e,Forbidden:()=>te,Found:()=>K,Gateway_Timeout:()=>be,Gone:()=>ae,HTTP_Version_Not_Supported:()=>ke,IM_Used:()=>D,Im_a_teapot:()=>le,Insufficient_Storage:()=>Fe,Internal_Server_Error:()=>Me,Length_Required:()=>se,Locked:()=>xe,Loop_Detected:()=>Te,Method_Not_Allowed:()=>A,Misdirected_Request:()=>ve,Moved_Permanently:()=>z,Multi_Status:()=>G,Multiple_Choices:()=>V,Network_Authentication_Required:()=>Ie,No_Content:()=>H,Non_Authoritative_Information:()=>q,Not_Acceptable:()=>re,Not_Extended:()=>Ee,Not_Found:()=>y,Not_Implemented:()=>Ne,Not_Modified:()=>J,OK:()=>I,Partial_Content:()=>j,Payment_Required:()=>ee,Permanent_Redirect:()=>X,Precondition_Failed:()=>pe,Precondition_Required:()=>Re,Processing:()=>T,Proxy_Authentication_Required:()=>oe,Range_Not_Satisfiable:()=>ce,Request_Header_Fields_Too_Large:()=>Ae,Request_Timeout:()=>ie,Reset_Content:()=>O,See_Other:()=>W,Service_Unavailable:()=>Se,Switching_Protocols:()=>F,Temporary_Redirect:()=>Q,Too_Early:()=>ye,Too_Many_Requests:()=>ge,URI_Too_Long:()=>de,Unauthorized:()=>Z,Unavailable_For_Legal_Reasons:()=>$e,Unprocessable_Content:()=>me,Unsupported_Media_Type:()=>ue,Upgrade_Required:()=>we,Variant_Also_Negotiates:()=>Ce});var C=100,F=101,T=102,E=103,I=200,L=201,U=202,q=203,H=204,O=205,j=206,G=207,B=208,D=226,V=300,z=301,K=302,W=303,J=304,Q=307,X=308,Y=400,Z=401,ee=402,te=403,y=404,A=405,re=406,oe=407,ie=408,ne=409,ae=410,se=411,pe=412,he=413,de=414,ue=415,ce=416,fe=417,le=418,ve=421,me=422,xe=423,_e=424,ye=425,we=426,Re=428,ge=429,Ae=431,$e=451,Me=500,Ne=501,Pe=502,Se=503,be=504,ke=505,Ce=506,Fe=507,Te=508,Ee=510,Ie=511;var b=n(async(o,e,t,r)=>{var p=r.params={},d=e.url.split("/"),i=o.root;for(let h=1;h<d.length;h++){let u=d[h];if(i.routes[u])i=i.routes[u];else if(i.routes["[PARAM]"])i=i.routes["[PARAM]"],p[i.name]=u;else if(i.portal){r.path=d.slice(h);break}else return o.error(w,y,e,t)}i.portal&&!r.path&&(r.path=[]);var a=e.method.toLowerCase(),f=i.handler;if(!f)return o.error(R,y,e,t,i);if(typeof f=="object")if(f[a])f=f[a];else return o.error(g,A,e,t,a);var x=o.middlewares;for(let h=0;h<x.length;h++)await new Promise(u=>x[h](e,t,r,u));f(e,t,r)},"handleRoute");var m=class{constructor(e=[]){N(e,"middlewares"),e.forEach((t,r)=>l(t,`middleware at index (${r})`)),this.middlewares=e,this.root=new c,this.listener=this.handle.bind(this)}handle(e,t,r={}){b(this,e,t,r)}use(...e){e.forEach((t,r)=>l(t,`middleware at index (${r})`)),this.middlewares.push(...e)}error(e,t,r,p,...d){p.writeHead(t),p.end()}route(e,t,r={}){return _(e,this.root,this,t,r,c)}all(e,t){return this.route(e,t)}connect(e,t){return this.route(e).method("connect",t)}delete(e,t){return this.route(e).method("delete",t)}get(e,t){return this.route(e).method("get",t)}head(e,t){return this.route(e).method("head",t)}options(e,t){return this.route(e).method("options",t)}patch(e,t){return this.route(e).method("patch",t)}post(e,t){return this.route(e).method("post",t)}put(e,t){return this.route(e).method("put",t)}trace(e,t){return this.route(e).method("trace",t)}};n(m,"Router");var Le=n(o=>new m(o),"make"),ut=Le;export{U as Accepted,B as Already_Reported,Pe as Bad_Gateway,Y as Bad_Request,ne as Conflict,he as Content_Too_Large,C as Continue,L as Created,E as Early_Hints,fe as Expectation_Failed,_e as Failed_Dependency,te as Forbidden,K as Found,be as Gateway_Timeout,ae as Gone,ke as HTTP_Version_Not_Supported,D as IM_Used,le as Im_a_teapot,Fe as Insufficient_Storage,Me as Internal_Server_Error,se as Length_Required,xe as Locked,Te as Loop_Detected,A as Method_Not_Allowed,ve as Misdirected_Request,z as Moved_Permanently,G as Multi_Status,V as Multiple_Choices,Ie as Network_Authentication_Required,H as No_Content,q as Non_Authoritative_Information,re as Not_Acceptable,Ee as Not_Extended,y as Not_Found,Ne as Not_Implemented,J as Not_Modified,I as OK,j as Partial_Content,ee as Payment_Required,X as Permanent_Redirect,pe as Precondition_Failed,Re as Precondition_Required,T as Processing,oe as Proxy_Authentication_Required,ce as Range_Not_Satisfiable,Ae as Request_Header_Fields_Too_Large,ie as Request_Timeout,O as Reset_Content,c as Route,m as Router,W as See_Other,s as ServerError,Se as Service_Unavailable,F as Switching_Protocols,Q as Temporary_Redirect,ye as Too_Early,ge as Too_Many_Requests,de as URI_Too_Long,Z as Unauthorized,$e as Unavailable_For_Legal_Reasons,me as Unprocessable_Content,ue as Unsupported_Media_Type,we as Upgrade_Required,Ce as Variant_Also_Negotiates,ut as default,P as errorCodes,S as httpStatus,Le as make,R as no_handler,g as undefined_method,w as undefined_route};
