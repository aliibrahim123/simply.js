var b=Object.defineProperty;var l=(e,t)=>b(e,"name",{value:t,configurable:!0});var c=l(e=>{if(!e?.nodeType)throw new TypeError("edit: element of type ("+e?.constructor?.name+"), expected (Element)");e.after(...e.childNodes),e.remove()},"unwrap"),C=l(()=>{var e=getSelection();if(e.rangeCount){var t=e.getRangeAt(0),r=t.startContainer;for(r.nodeType!==r.ELEMENT_NODE&&(r=r.parentElement);!r.hasAttribute("contenteditable");){if(r===document.body)return;r=r.parentElement}return r}},"getContainer"),N=l((e,t,r)=>{if(!e?.nodeType)throw new TypeError("edit: element of type ("+e?.constructor?.name+"), expected (Element)");var s=e.cloneNode(!1),i=!1;return[...e.childNodes].forEach(n=>(i||(i=n===t))&&s.append(n)),r?r.prepend(s):e.after(s),s},"splitEl"),p=l((e,t)=>{var r=getSelection();if(r.rangeCount){var s=r.getRangeAt(0),i=C();if(i)for(var n=s.commonAncestorContainer;n!==i;){if(n.tagName===e.toUpperCase()&&(!t||t(n)))return n;n=n.parentElement}}},"getWrapped");var m=l((e,t,r=!0,s,i={})=>{t=t.toLowerCase();var n=[...e.getElementsByTagName(t)];r&&e.tagName===t.toUpperCase()&&n.push(e),n=n.filter(a=>[...a.classList].every(o=>o in g?g[o](a,i[o]):!0)),s&&(n=n.filter(s)),n.forEach(a=>c(a))},"clean"),y=l((e,t=new Set)=>{if(!e?.nodeType)throw new TypeError("edit: element of type ("+e?.constructor?.name+"), expected (Element)");if(e.nodeType===e.ELEMENT_NODE){var r=[...e.childNodes];e.childNodes.length===0?e.remove():e.tagName===e.previousSibling?.tagName?(e.previousSibling.append(...r),e.remove()):t.has(e.tagName)&&![...e.classList].some(s=>s in g)&&(e.after(...r),e.remove()),r.forEach(s=>y(s,new Set([...t,e.tagName])))}else e.textContent===""?e.remove():e.previousSibling?.nodeType===e.TEXT_NODE&&(e.previousSibling.textContent+=e.textContent,e.remove())},"cleanDom"),g={styled(e,t){if(!t)return!1;var[r,s]=t;return e.classList.contains(s+r)&&(e.classList.remove(s+r),e.style[r]=""),[...e.classList].reduce((i,n)=>n.startsWith(s)?i+1:i,0)===0}};var T={unwrap:c,getContainer:C,splitEl:N,getWrapped:p,clean:m,cleanDom:y,cleanMap:g,isWrappedWith(e,t){return!!p(e,t)},surround(e,t=!0,r,s){if(!e?.nodeType)throw new TypeError("edit: wrapper of type ("+e?.constructor?.name+"), expected (Element)");var i=getSelection();if(!i.rangeCount)return{success:!1};var n=i.getRangeAt(0);return e.append(...n.cloneContents().childNodes),n.deleteContents(),t&&m(e,e.tagName,!1,r,s),n.insertNode(e),{success:!0,type:"surround",node:e}},undo(e,t,r){var s=getSelection();if(!s.rangeCount)return{success:!1};var i=s.getRangeAt(0),n=i.cloneContents();i.deleteContents();var a=document.createElement("span");a.append(n),m(a,e,!1,t,r),i.insertNode(a);var o=p(e,t);if(!o)return c(a),{success:!0,type:"undo"};for(var d=a,f=[d];d!==o;)d=d.parentElement,f.unshift(d);var x;f.forEach((u,v)=>{v!==0&&(x=N(u.parentElement,u.nextSibling,x))});var h=f.reduce((u,v,S)=>{if(S===f.length-1)return u;var E=v.cloneNode(!1);return u===o?u.after(E):u.append(E),E});return h===o?o.after(a):h.append(a),i.selectNode(h),c(a),{success:!0,type:"undo"}},replace(e="",t="text",r=!1){var s=getSelection();if(!s.rangeCount)return{success:!1};var i=s.getRangeAt(0);if(i.deleteContents(),t==="node")i.insertNode(e);else{let n=document.createElement("span");if(t==="text")n.innerText=e;else if(t==="html")n.innerHTML=e;else throw new Error("edit: undefined replace type ("+t+")");i.insertNode(n),r&&r(n)}return{success:!0,type:"replace"}},applyCss(e,t,r="span",s="styled-",i=!0,n){var a=document.createElement(r);return a.classList.add("styled"),a.classList.add(s+e),a.style[e]=t,this.surround(a,i,n,{styled:[e,s]})},copy(){return getSelection().toString()},delete(){var e=getSelection();if(!e.rangeCount)return{success:!1};var t=e.getRangeAt(0);return t.deleteContents(),{success:!0,type:"delete"}},insert(e,t="text",r=!1){var s=getSelection();if(!s.rangeCount)return{success:!1};var i=s.getRangeAt(0);if(t==="node")i.insertNode(e);else{var n=document.createElement("span");if(t==="text")n.innerText=e;else if(t==="html")n.innerHTML=e;else throw new Error("edit: undefined insert type ("+t+")");i.insertNode(n),r&&r(n)}return{success:!0,type:"insert"}},toggle(e,t=0,r,s,i){var n;if(e?.nodeType?(n=e,e=e.tagName.toLowerCase()):n=document.createElement(e),t===0)return this.isWrappedWith(e)?this.undo(e,s,i):this.surround(n,r,s,i);if(t===1)return this.surround(n,r,s,i);if(t===2)return this.undo(e,s,i);throw new Error("edit: toggle type is ("+t+"), expected 0, 1, or 2")},removeFormat(){var e=getSelection();if(!e.rangeCount)return{success:!1};var t=e.getRangeAt(0),r=e.toString();return t.deleteContents(),t.insertNode(new Text(r)),{success:!0,type:"remove-format"}},selectParagraph(){var e=getSelection();if(!e.rangeCount)return{success:!1};var t=e.getRangeAt(0),r=p("p");return r?(t.selectNode(r),{success:!0,type:"select"}):this.selectAll()},selectAll(){var e=getSelection();if(!e.rangeCount)return{success:!1};var t=e.getRangeAt(0),r=this.getContainer();return t.setStart(r.firstChild,0),t.setEnd(r.lastChild,r.lastChild.childNodes.length),{success:!0,type:"select"}},bold(e){return this.toggle("b",e)},underline(e){return this.toggle("u",e)},italic(e){return this.toggle("i",e)},strikeThrough(e){return this.toggle("s",e)},subscript(e){return this.toggle("sub",e)},superscript(e){return this.toggle("sup",e)},backColor(e){return this.applyCss("background-color",e||"initial")},fontColor(e){return this.applyCss("color",e||"initial")},fontName(e){return this.applyCss("font-family",e||"initial")},fontSize(e){return this.applyCss("font-size",e||"initial")},link(e,t=!1){var r=document.createElement("a");return r.href=e,t&&this.isWrappedWith("a")?this.undo("a"):this.surround(r)},img(e){var t=document.createElement("img");return t.src=e,this.insert(t,"node")},heading(e=1,t){return this.toggle("h"+e,t)},orderedList(){var e=this.surround(document.createElement("li")),t=document.createElement("ol");return e.node.before(t),t.append(e.node),e},unorderedList(){var e=this.surround(document.createElement("li")),t=document.createElement("li");return e.node.before(t),t.append(e.node),e},block(e){return this.toggle("div",e)},inline(e){return this.toggle("span",e)},paragraph(e){return this.toggle("p",e)},indent(e){return this.selectParagraph(),this.applyCss("text-indent",e||"initial")},align(e){return this.selectParagraph(),this.applyCss("text-align",e||"initial","div")},hr(){return this.insert(document.createElement("hr"),"node")}};globalThis.$edit=T;var P=T;export{P as default};
