var N=Object.defineProperty;var s=(r,e)=>N(r,"name",{value:e,configurable:!0});var $=s((r,e)=>{if(typeof r!="string")throw new TypeError(`csv: ${e} of type (${r?.constructor?.name}), expected (String)`)},"checkstr"),E=s((r,e)=>{if(!Array.isArray(r))throw new TypeError(`csv: ${e} of type (${r?.constructor?.name}), expected (Array)`)},"checkarr");var R=s((r,e)=>{if(typeof r!="string"&&!(r instanceof RegExp))throw new TypeError(`csv: ${e} of type (${r?.constructor?.name}), expected (String) or (RegExp)`)},"checkstrReg"),x=[",",";","|","	","^"],S=s(r=>new RegExp(`(?:[^${r}
\r]+|(?:${r}(?:${r}${r}|[^${r}])*${r}))+`,"g"),"lineMatcher"),T=s((r,e)=>new RegExp(`(?:[^${r}${e}]+|(?:${e}(?:${e}${e}|[^${e}])*${e}))+`,"g"),"cellMatcher"),y=Symbol("auto"),k=s(r=>{var e=x.map(n=>Math.min(...r.map(t=>t.split(n).length))),[o,d]=e.reduce(([n,t],p,f)=>p>t?[f,p]:[n,t],[0,0]);return x[o]},"detectSeparator"),A=s((r,e,o)=>(r=String(r),r.match(o)?`${e}${r.replaceAll(e,e+e)}${e}`:r),"encodeCell"),M=s((r,e={})=>{var{separator:o,lineEnd:d,quote:n}={separator:",",lineEnd:`\r
`,quote:'"',...e};E(r,"data"),$(o,"separator"),$(d,"lineEnd"),$(n,"quote");var t=new RegExp("["+d+o+n+"]"),p=Array.isArray(r[0])?!1:Object.keys(r[0]),f=p?p.map(h=>A(h,n,t)).join(o)+d:"",g=r.map(h=>(p&&(h=p.map(i=>h[i])),h.map(i=>A(i,n,t)).join(o))).join(d);return f+g},"encode"),j=s((r,e={})=>{var{separator:o,lineEnd:d,quote:n,headers:t,trim:p,cast:f,throwLengthNotEqual:g}={separator:y,lineEnd:"",quote:'"',headers:!0,trim:!1,cast:!0,throwLengthNotEqual:!0,...e};$(r,"data"),o!==y&&$(o,"separator"),R(d,"lineEnd"),$(n,"quote"),t!==!0&&t!==!1&&E(t,"headers"),f!==!0&&f!==!1&&E(f,"cast");var h=d||S(n),i=r.match(h);o===y&&(o=k(i));var b=T(o,n);return i=i.map(u=>u.match(b).map(c=>(p&&(c=c.trim()),c[0]===n&&(c=c.slice(1,-1).replaceAll(n+n,n)),c))),t===!0&&(t=i[0],i=i.slice(1)),i.map((u,c)=>{if(t&&t.length!==u.length&&g)throw new RangeError(`csv: line (${c}) of length (${u.length}), expected (${t.length})`);return Array.isArray(f)?u=u.map((a,v)=>{var m=f[v];if(m==="string")return a;if(m==="number")return Number(a);if(a==="true")return!0;if(a==="false")return!1;if(a!=="undefined"){if(a==="null")return null;if(m==="date")return new Date(a);if(m==="json")return JSON.parse(a);throw new TypeError(`csv: undefined casting type (${m})`)}}):f&&(u=u.map(a=>{if(a==="true")return!0;if(a==="false")return!1;if(a!=="undefined"){if(a==="null")return null;var v=Number(a);return Number.isNaN(v)?a:v}})),t&&(u=u.reduce((a,v,m)=>(a[t[m]]=v,a),{})),u})},"decode"),w={encode:M,decode:j};globalThis.$csv=w;var D=w;export{R as checkstrReg,j as decode,D as default,M as encode};
